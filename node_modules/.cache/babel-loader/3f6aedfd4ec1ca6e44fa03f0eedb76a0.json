{"ast":null,"code":"import fire from '../config/firebaseConfig';\nimport refresh4User from './refresh4User';\nimport getAllUsers from './getAllUsers';\nimport getAllRegionTasks from './getAllRegionTasks';\nimport Router from 'next/router';\nexport default function checkAuthAndRefresh(dispatch) {\n  fire.auth().onAuthStateChanged(function (user) {\n    var db = fire.firestore();\n    console.log(user);\n\n    if (user) {\n      db.collection(\"users\").doc(user.uid).get().then(function (doc) {\n        dispatch({\n          type: 'LOGIN',\n          user: doc.data(),\n          uid: user.uid\n        });\n\n        if (doc.data().admin == false) {\n          refresh4User(dispatch, doc.data().region, user.uid);\n        } else {\n          getAllUsers(dispatch);\n          getAllRegionTasks(dispatch, doc.data().region);\n        }\n\n        dispatch({\n          type: 'AUTHCHECKED'\n        });\n      });\n    } else {\n      Router.push('/login');\n      dispatch({\n        type: 'AUTHCHECKED'\n      });\n    }\n  });\n}","map":null,"metadata":{},"sourceType":"module"}